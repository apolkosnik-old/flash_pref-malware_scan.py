"""
#===========================================================
#
# FILE: flash_pref-malware_scan.py
#
#
# DESCRIPTION: This script is used for listing and 
#	submitting urls that have been created under the 
#	flash player preferences folder while browsing
#	with Firefox. 
#	
#	The url list is submitted to VirusTotal.com
#	public API to check each of the urls if they are 
#	known as a "Malware site"
#	against diffrent antivirus vendors. 
#	You must have a virustotal.com
#	account and a public API key to use this program.
#
# BUGS: not yet configured for windows xp, vista or 7
#		While using linux, multiple flags not configured yet.
# NOTES: Coded using Python 2.6.1 on OSX 10.6 and bt5
#
# AUTHOR: Alejandro Laboy - alejandro[AT]vliot.com
# CREATED: 7/23/11
#============================================================
"""



	USAGE EXAMPLE:
--------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------
root@bt:# ./flash_pref-malware_scan.py -h

Usage: flash_pref-malware_scan.py  <options>
                 
Options:
        -v      verbose  mode. Prints all
                the results from the diffrent AV vendors.

        -h      --help                          This help message.

        -p 	--path	Path to Flash Player (sys) folder
				example path: /Flash_Player/macromedia.com/support/flashplayer/sys/
				example path: /Users/{username}/Library/Preferences/Macromedia/Flash Player/macromedia.com/support/flashplayer/sys/





root@bt:# ./flash_pref-malware_scan.py
[*] linux OS detected...
[*] Platform: linux2

[*] Enumerating urls from path ...
[*] Getting detections from virusatotal.com API ...

[*] The url  38zu.cn
 IS flagged as a (Malware site) 

[*] End of urls reached
 URLS scanned:  2

 will now exit.
root@bt:# ./flash_pref-malware_scan.py -v
[*] linux OS detected...
[*] Platform: linux2

[*] Enumerating urls from path ...
[*] Getting detections from virusatotal.com API ...

[*] Printing in verbose mode
[*] Printing list of found urls:  ['#38zu.cn', '#s.ytimg.com']
[*] Scanning right now url: 38zu.cn

[!] Found Malware flags from the following vendors: 

TrendMicro": "Malware site"
Data": "Malware site"
BitDefender": "Malware site"
ThreatSeeker": "Malware site"




[*] End of urls reached
 URLS scanned:  2

 will now exit.
--------------------------------------------------------------
--------------------------------------------------------------
